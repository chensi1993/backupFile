<!DOCTYPE HTML>
<html>
  <head>
		<title>正式版本</title>
	  	<meta charset="utf-8">
		<meta http-equiv="pragma" content="no-cache">
		<meta http-equiv="cache-control" content="no-cache">
		<meta http-equiv="expires" content="0">
		<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
		<meta http-equiv="description" content="This is my page">
		<meta name="viewport" content="initial-scale=1,width=device-width, maximum-scale=1, minimum-scale=1, user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta content="yes" name="apple-touch-fullscreen">
		<meta name="App-Config" content="fullscreen=yes,useHistoryState=yes,transition=yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no,email=no">
		<link rel="stylesheet" type="text/css" href="./css/demo.css">
		<link rel="stylesheet" type="text/css" href="./css/microdone-h5.css">
		<script type="text/javascript" src="./js/jquery-3.0.0.min.js"></script>
		<script type="text/javascript" src="./js/demo.js"></script>
		<script type="text/javascript" src="./js/microdoneH5.js"></script>
		<script type="text/javascript">
			var kb = new keyBoard( {
				"chaosMode" : 0, // 混乱模式,0:无混乱;1:打开时乱一次;2:每输入一个字符乱一次,默认值0
				"pressStatus" : 1, // 按键状态,0:按下、抬起按键无变化;1:按下、抬起按键的颜色变化,默认值0
				"kbType" : 0, // 键盘类型,0:全键盘;1:纯数字键盘,默认值0
				"svg" : "svg",//svg图片的地址
				"hasMap" : "0",//是否调用mapping值：当为1时调用，当为非1时，不调用
				"license" : "YytaZmJyZEM0M1ZEV1VZcmEvaXduNmZiSlRROWlEblcrdkZzZFcxUXdHSndvVWlCamZjRGRId2tuSnBEN3pJRFpSVDREQ1pTSVYxTmZ6L21kYkk2c2NXbUVQSVdnRGZSNldPSnAzQkgyVThwTUs1SXdoeTdCc1BBQUJ5em9vd2JLODFmcVpIbkF4SUkxNFY1QzdDRjZSREZCSmduS1N1QzMrMVVYNFFWNkVVPXsiaWQiOjAsInR5cGUiOiJ0ZXN0IiwicGxhdGZvcm0iOjEwLCJub3RiZWZvcmUiOiIyMDE4MDQxMyIsIm5vdGFmdGVyIjoiMjAxODA3MTMifQ=="
			});
			//设置映射数组,此处为了方便demo演示，写死了，正常应该由
			//服务器端下发映射数组
			passGuard.mapArr = "Wyc0MycsICc1NycsICc3MScsICcxMjEnLCAnMTI2JywgJzEyNCcsICc5MCcsICcxMTInLCAnODknLCAnOTMnLCAnMTA1JywgJzgxJywgJzExMycsICcxMjUnLCAnNjgnLCAnMzgnLCAnODUnLCAnNjUnLCAnMTE4JywgJzgwJywgJzg3JywgJzkxJywgJzQ0JywgJzMzJywgJzc4JywgJzg4JywgJzk2JywgJzEwOScsICc2MScsICc2NicsICc0MCcsICc4MicsICc3MicsICcxMjAnLCAnOTUnLCAnMTEwJywgJzQ2JywgJzg2JywgJzEwNycsICc1MCcsICc3MCcsICc5OCcsICcxMTcnLCAnMzYnLCAnMTAxJywgJzgzJywgJzQ4JywgJzExNCcsICc2NycsICc3NycsICcxMDgnLCAnMTAwJywgJzM1JywgJzczJywgJzY5JywgJzk5JywgJzEwMicsICc3NicsICc3NScsICcxMDQnLCAnNDknLCAnOTInLCAnNjInLCAnNTgnLCAnNTMnLCAnNzknLCAnOTcnLCAnNDUnLCAnNDEnLCAnMTE5JywgJzEyMycsICc1MScsICc2MycsICc0NycsICcxMDYnLCAnMzknLCAnMTExJywgJzExNScsICczNCcsICc5NCcsICcxMjInLCAnNjQnLCAnNTknLCAnMTE2JywgJzM3JywgJzc0JywgJzU1JywgJzYwJywgJzU0JywgJzUyJywgJzQyJywgJzg0JywgJzEwMycsICc1Nidd";
			var passGuard1 = new passGuard({
				"mappurl":"./send_mapping.jsp",
				"jump": 1, //是否用添加删除回调：1代表使用，0代表不使用
				"add": tianjia, //输入框值添加回调,当jump为1时，才有回调
				"del": jianshao, //输入框值减少回调,当jump为1时，才有回调
				"maxLength": 6, // 最大输入长度
				"regExp1":"[\\S\\s]", // 输入过程限制的正则
				"regExp2":"[0-9]{6,12}",
				"displayMode": 0, // 显示形式,0:星号;1:明文,默认值0
				"callBack": cb5, //成功回调
				"errorCallBack": cb6, //失败回调
				"focus":inputFocus1,//H5键盘获取焦点回调
			    "blur":inputBlur1,//H5键盘失去焦点回调
				"rsaPublicKey":"3081890281810092d9d8d04fb5f8ef9b8374f21690fd46fdbf49b40eeccdf416b4e2ac2044b0cfe3bd67eb4416b26fd18c9d3833770a526fd1ab66a83ed969af74238d6c900403fc498154ec74eaf420e7338675cad7f19332b4a56be4ff946b662a3c2d217efbe4dc646fb742b8c62bfe8e25fd5dc59e7540695fa8b9cd5bfd9f92dfad009d230203010001" // rsa公钥
			});
			
			function inputFocus1(){
				console.log("passGuard1输入框获得焦点");
			}
			function inputBlur1(){
				console.log("passGuard1输入框失去焦点");
			}
			
			function cb5() {
				$(".cover").hide();
				$(".cover-Div").hide();
				$(".kb1 li").html("");
				console.log("开始提交");
				console.log(passGuard1.getOutput());
				//formSubmit(); //输入成功跳转
			}
	
			function cb6() {
				console.log("失败3");
			}
			
			function tianjia(xh) { //xh为密码的长度
				$(".kb1>li").eq(xh - 1).append($("<p class='yuan'></p>"));
				if(xh == 6) {
					kb.hide();
				}
			}
	
			function jianshao(xh) {
				$(".kb1>li").eq(xh).html("");
			}
		</script>
		<style>
			.cover {
				position: absolute;
				position: fixed;
				z-index: 1000;
				top: 0px;
				left: 0px;
				width: 100%;
				height: 100%;
				background: Rgba(000, 000, 000, 0.3);
				display: none;
			}
			
			.cover-Div {
				width: 80%;
				height: 150px;
				margin: 0 auto;
				background: #fff;
				border-radius: 5px;
				margin-top: 50px;
				position: relative;
				display: none;
			}
			
			.pay {
				position: relative;
				width: 90%;
				height: 28px;
				margin: 0 auto;
			}
			
			.close {
				position: absolute;
				right: 0;
				top: 0;
				width: 30px;
				height: 30px;
				text-align: center;
				line-height: 30px;
				font-size: 20px;
			}
			
			.title {
				width: 100%;
				height: 30px;
				line-height: 30px;
				padding-top: 20px;
				text-align: center;
				margin-bottom: 10px;
			}
			
			#kb1 {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: auto;
				border: 0;
				opacity: 0;
				z-index: 999;
			}
			
			.kb1 {
				width: 100%;
				height: auto;
				overflow: hidden;
			}
			
			.kb1 li {
				width: 16.6%;
				list-style: none;
				height: 28px;
				line-height: 25px;
				font-family:"PingFang";
				text-align: center;
				border: 1px solid #999999;
				background-color: #fff;
				font-size: 20px;
				color: #646464;
				float: left;
				border-left: 0;
				box-sizing: border-box;
				position: relative;
			}
			
			.yuan {
				width: 16px;
				height: 16px;
				background: #666;
				border-radius: 50%;
				position: relative;
				top: 50%;
				left: 50%;
				-webkit-transform: translate3d(-50%, -50%, 0);
				transform: translate3d(-50%, -50%, 0);
			}
			
		</style>
	</head>
  <body>
  	<form id="form1" name="form1" method="post" action="decrypt.jsp">
    	<div id="Main">
				<div id="TitleBar">
					<div id="LogoBg_Topbar">
						北京微通新成手机网银密码控件Demo
					</div>
					<div id="LoginTab">
						<div class="on">登录场景</div>
					</div>
				</div>
        <div id="InputBlock">
          <div id="InputInfoTable">
            <div class="line5px" ></div>
						<table class="InputLine">
							<tbody>
								<tr>
									<td class="left" align="right">
										<table class="AutoAlignLabel">
											<tr>
												<td class="BeginWord">账</td>
												<td class="EndWord">号</td>
											</tr>
										</table>
									</td>
									<td class="right" align="left">
										<input type="text" value="tester" id="username2" name="username" class="de2 NoneInput90" maxlength="50" tabindex="1" />
									</td>
								</tr>
							</tbody>
						</table>
					</div>
					<div>
						<table id="LoginBtn">
							<tr>
								<td class="default">
									输入交易密码
								</td>
							</tr>
						</table>
					</div>
				</div>
			</div>
			<input type="hidden" name="password" id="password" value="" />
			<input type="hidden" name="repassword" id="repassword" value="" />
			<!--模拟6个格子-->
			<div class="cover">
				<div class="cover-Div">
					<p class="close">×</p>
					<p class="title">请输入支付密码</p>
					<div class="pay">
						<input type="text" readonly="readonly" id="kb1" name="input3" class="default NoneInput90" maxlength="50" tabindex="3" />
						<!--输入密码格子的ul标签，class名要跟对应的input框的id名相同-->
			    	<script>
							//初始化密码卫士,绑定键盘对象。数字参数：0代表全键盘，1代表数字键盘
							passGuard1.generate("kb1",kb,"passGuard1",1);
						</script>
						<ul class="kb1">
							<li style="border-left:1px solid #999999"></li>
							<li></li>
							<li></li>
							<li></li>
							<li></li>
							<li></li>
						</ul>
					</div>
				</div>
			</div>
		</form>
			<script type="text/javascript">
				window.onload = function() {
					Le = 1;//调用H5键盘的input框
					for(var i=1;i<=1;i++){//PH.arrPlace-->H5输入框的placeholder数组；PH.arrId-->H5输入框的id数组
						$("#"+PH.arrId[i-1]).val("");
					}
					setTimeout(function() {
						kb.generate();
						Show = 0;
					}, 100);
					//输入密码格子样式
					var liHeight = document.documentElement.clientWidth * 0.81 * 0.166;
					$(".kb1>li").css({
						height: liHeight +"px",
						lineHeight: liHeight +"px"
					});
					$("#kb1").css({
						height: liHeight +"px"
					});
					$("#LoginBtn").on("touchstart", function() {
						$(".cover").fadeIn(300);
						$(".cover-Div").show();
						setTimeout(function() {
							$("#kb1").focus(); //调用键盘
						}, 50)
					});
					$(".close").on("touchend", function() {
						$(".cover").fadeOut(300);
						$(".cover-Div").hide();
						clearpwd();
					});
					$(document).on("touchstart", function(e) {
						if(e.target.className.indexOf("cover") > -1) {
							clearpwd(); 
							$(".cover").hide();
							$(".cover-Div").hide();
							e.preventDefault();
						}
					});
					//关闭6个格子时，删除密码
					function clearpwd(){
						$("#kb1").val("");
						passGuard1.getOutput();//对应键盘的密文清空 
						$(".kb1 li").html("");//对应输入密码格子清空 
					}
				};
			</script>
	</body>
</html>
